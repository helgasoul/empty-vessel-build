
import { ComprehensiveHealthContext } from '../types/aiTypes';

export const generateAdvancedMockResponse = async (message: string, context: ComprehensiveHealthContext) => {
  const lowerMessage = message.toLowerCase();
  
  if (lowerMessage.includes('–∞–Ω–∞–ª–∏–∑') || lowerMessage.includes('—Å–æ—Å—Ç–æ—è–Ω–∏–µ')) {
    return {
      content: `–ù–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π:

üîç **–û–±—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: ${context.cycleTrends?.regularityScore && context.cycleTrends.regularityScore > 70 ? '–•–æ—Ä–æ—à–µ–µ' : '–¢—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è'}

üìä **–ö–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏**:
‚Ä¢ –†–µ–≥—É–ª—è—Ä–Ω–æ—Å—Ç—å —Ü–∏–∫–ª–∞: ${context.cycleTrends?.regularityScore?.toFixed(0) || '–Ω/–¥'}%
‚Ä¢ –¢–µ–∫—É—â–∞—è —Ñ–∞–∑–∞: ${context.cyclePhase} (–¥–µ–Ω—å ${context.currentCycleDay})
‚Ä¢ –°—Ä–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: ${context.healthMetrics?.steps || '–Ω/–¥'} —à–∞–≥–æ–≤/–¥–µ–Ω—å
‚Ä¢ –ö–∞—á–µ—Å—Ç–≤–æ —Å–Ω–∞: ${context.healthMetrics?.sleep || '–Ω/–¥'} —á–∞—Å–æ–≤

üéØ **–ì–ª–∞–≤–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**:
${context.recommendations?.immediate?.map(rec => `‚Ä¢ ${rec}`).join('\n') || '‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤–µ–¥–µ–Ω–∏–µ –¥–Ω–µ–≤–Ω–∏–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è'}

üìà **–ü—Ä–æ–≥–Ω–æ–∑**: –°–ª–µ–¥—É—é—â–∏–π —Ü–∏–∫–ª –æ–∂–∏–¥–∞–µ—Ç—Å—è ${context.predictions?.nextCycleStart || '—á–µ—Ä–µ–∑ 28 –¥–Ω–µ–π'}`,
      context: 'analysis',
      attachments: [{
        type: 'chart' as const,
        data: { type: 'health_overview', metrics: context.healthMetrics }
      }]
    };
  }

  if (lowerMessage.includes('—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫') || lowerMessage.includes('—Å–ø–æ—Ä—Ç')) {
    const optimalDays = context.predictions?.optimalWorkoutDays || [];
    return {
      content: `üèÉ‚Äç‚ôÄÔ∏è **–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞–º**:

‚ö° **–°–µ–π—á–∞—Å (${context.cyclePhase} —Ñ–∞–∑–∞)**:
${context.cyclePhase === 'follicular' ? '‚Ä¢ –û—Ç–ª–∏—á–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫\n‚Ä¢ –í—ã—Å–æ–∫–∞—è —ç–Ω–µ—Ä–≥–∏—è –∏ –º–æ—Ç–∏–≤–∞—Ü–∏—è\n‚Ä¢ –°–∏–ª–æ–≤—ã–µ –∏ HIIT —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏' :
  context.cyclePhase === 'ovulatory' ? '‚Ä¢ –ü–∏–∫–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ä–≥–∞–Ω–∏–∑–º–∞\n‚Ä¢ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å\n‚Ä¢ –ì—Ä—É–ø–ø–æ–≤—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∏ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è' :
  context.cyclePhase === 'luteal' ? '‚Ä¢ –£–º–µ—Ä–µ–Ω–Ω—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏\n‚Ä¢ –ë–æ–ª—å—à–µ –≤–Ω–∏–º–∞–Ω–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é\n‚Ä¢ –ô–æ–≥–∞, –ø–∏–ª–∞—Ç–µ—Å, —Ä–∞—Å—Ç—è–∂–∫–∞' :
  '‚Ä¢ –õ–µ–≥–∫–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏\n‚Ä¢ –§–æ–∫—É—Å –Ω–∞ —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–∏\n‚Ä¢ –ü—Ä–æ–≥—É–ª–∫–∏, –º—è–≥–∫–∞—è –π–æ–≥–∞'}

üìÖ **–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –¥–Ω–∏ –¥–ª—è –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫**: ${optimalDays.length ? optimalDays.join(', ') : '–û–ø—Ä–µ–¥–µ–ª—è–µ–º...'}

üìä **–í–∞—à–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏**: 
‚Ä¢ –°—Ä–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: ${context.healthMetrics?.steps || '–Ω/–¥'} —à–∞–≥–æ–≤
‚Ä¢ –£—Ä–æ–≤–µ–Ω—å —ç–Ω–µ—Ä–≥–∏–∏: ${context.moodAnalysis?.energyLevel || '–Ω/–¥'}/10
‚Ä¢ –¢—Ä–µ–Ω–¥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏: ${context.healthMetrics?.stepstrend === 'increasing' ? 'üìà –†–∞—Å—Ç–µ—Ç' : context.healthMetrics?.stepstrend === 'decreasing' ? 'üìâ –°–Ω–∏–∂–∞–µ—Ç—Å—è' : '‚û°Ô∏è –°—Ç–∞–±–∏–ª—å–Ω–æ'}`,
      context: 'health',
      attachments: [{
        type: 'recommendation' as const,
        data: { type: 'workout_plan', phase: context.cyclePhase }
      }]
    };
  }

  if (lowerMessage.includes('–ø–∏—Ç–∞–Ω–∏–µ') || lowerMessage.includes('–µ–¥–∞')) {
    const nutritionFocus = context.predictions?.nutritionFocus || [];
    return {
      content: `üçé **–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø–∏—Ç–∞–Ω–∏—é**:

üéØ **–§–æ–∫—É—Å —Å–µ–π—á–∞—Å** (${context.cyclePhase} —Ñ–∞–∑–∞):
${context.cyclePhase === 'menstrual' ? '‚Ä¢ –ñ–µ–ª–µ–∑–æ: –∫—Ä–∞—Å–Ω–æ–µ –º—è—Å–æ, —à–ø–∏–Ω–∞—Ç, –≥—Ä–∞–Ω–∞—Ç\n‚Ä¢ –ú–∞–≥–Ω–∏–π: —Ç–µ–º–Ω—ã–π —à–æ–∫–æ–ª–∞–¥, –æ—Ä–µ—Ö–∏\n‚Ä¢ –¢–µ–ø–ª—ã–µ –∂–∏–¥–∫–æ—Å—Ç–∏ –∏ —É—Å–ø–æ–∫–∞–∏–≤–∞—é—â–∏–µ —Ç—Ä–∞–≤—è–Ω—ã–µ —á–∞–∏' :
  context.cyclePhase === 'follicular' ? '‚Ä¢ –ë–µ–ª–æ–∫ –¥–ª—è —Ä–æ—Å—Ç–∞ —Ç–∫–∞–Ω–µ–π\n‚Ä¢ –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —É–≥–ª–µ–≤–æ–¥—ã –¥–ª—è —ç–Ω–µ—Ä–≥–∏–∏\n‚Ä¢ –ê–Ω—Ç–∏–æ–∫—Å–∏–¥–∞–Ω—Ç—ã: —è–≥–æ–¥—ã, –∑–µ–ª–µ–Ω—ã–π —á–∞–π' :
  context.cyclePhase === 'ovulatory' ? '‚Ä¢ –ö–ª–µ—Ç—á–∞—Ç–∫–∞ –¥–ª—è –¥–µ—Ç–æ–∫—Å–∏–∫–∞—Ü–∏–∏\n‚Ä¢ –ü—Ä–æ—Ç–∏–≤–æ–≤–æ—Å–ø–∞–ª–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã\n‚Ä¢ –ó–¥–æ—Ä–æ–≤—ã–µ –∂–∏—Ä—ã: –∞–≤–æ–∫–∞–¥–æ, –æ—Ä–µ—Ö–∏' :
  '‚Ä¢ –ö–∞–ª—å—Ü–∏–π –∏ –º–∞–≥–Ω–∏–π –¥–ª—è –ü–ú–°\n‚Ä¢ –°–ª–æ–∂–Ω—ã–µ —É–≥–ª–µ–≤–æ–¥—ã –¥–ª—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è\n‚Ä¢ –û–º–µ–≥–∞-3: —Ä—ã–±–∞, –ª—å–Ω—è–Ω–æ–µ —Å–µ–º—è'}

üß™ **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö**:
${nutritionFocus.length ? nutritionFocus.map(focus => `‚Ä¢ ${focus}`).join('\n') : '‚Ä¢ –ë–∞–∑–æ–≤–∞—è —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–∏–µ—Ç–∞'}

${context.moodAnalysis?.stressLevel && context.moodAnalysis.stressLevel > 6 ? '\n‚ö†Ô∏è **–ê–Ω—Ç–∏—Å—Ç—Ä–µ—Å—Å**: –î–æ–±–∞–≤—å—Ç–µ –∞–¥–∞–ø—Ç–æ–≥–µ–Ω—ã (–∞—à–≤–∞–≥–∞–Ω–¥–∞), –∑–µ–ª–µ–Ω—ã–π —á–∞–π, –∏–∑–±–µ–≥–∞–π—Ç–µ –∫–æ—Ñ–µ–∏–Ω–∞ –ø–æ—Å–ª–µ 14:00' : ''}`,
      context: 'health'
    };
  }

  if (lowerMessage.includes('—Å–∏–º–ø—Ç–æ–º') || lowerMessage.includes('—Å–∞–º–æ—á—É–≤—Å—Ç–≤')) {
    const correlations = context.moodAnalysis?.correlations || [];
    return {
      content: `ü©∫ **–ê–Ω–∞–ª–∏–∑ –≤–∞—à–∏—Ö —Å–∏–º–ø—Ç–æ–º–æ–≤**:

üìã **–ß–∞—Å—Ç—ã–µ —Å–∏–º–ø—Ç–æ–º—ã**: ${context.cycleTrends?.symptomPatterns?.join(', ') || '–î–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ'}

üîó **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ**:
${correlations.map(corr => `‚Ä¢ ${corr.symptom}: –≤–ª–∏—è–Ω–∏–µ ${corr.impact.toFixed(1)}/10`).join('\n') || '‚Ä¢ –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏...'}

üìä **–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**:
‚Ä¢ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ: ${context.moodAnalysis?.currentRating || '–Ω/–¥'}/10
‚Ä¢ –°—Ç—Ä–µ—Å—Å: ${context.moodAnalysis?.stressLevel || '–Ω/–¥'}/10  
‚Ä¢ –≠–Ω–µ—Ä–≥–∏—è: ${context.moodAnalysis?.energyLevel || '–Ω/–¥'}/10

üí° **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**:
${context.moodAnalysis?.stressLevel && context.moodAnalysis.stressLevel > 6 ? 
  '‚Ä¢ –í—ã—Å–æ–∫–∏–π —Å—Ç—Ä–µ—Å—Å: –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è\n‚Ä¢ –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –º–µ–¥–∏—Ç–∞—Ü–∏—é –∏–ª–∏ –π–æ–≥—É\n‚Ä¢ –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—É –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏' :
  '‚Ä¢ –í–µ–¥–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫ —Å–∏–º–ø—Ç–æ–º–æ–≤\n‚Ä¢ –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ç—Ä–∏–≥–≥–µ—Ä—ã\n‚Ä¢ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –∑–¥–æ—Ä–æ–≤—ã–π —Ä–µ–∂–∏–º —Å–Ω–∞'}

${correlations.length > 0 ? `\nüéØ **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –†–∞–±–æ—Ç–∞–π—Ç–µ –Ω–∞–¥ —Å–Ω–∏–∂–µ–Ω–∏–µ–º "${correlations[0].symptom}" - —ç—Ç–æ –Ω–∞–∏–±–æ–ª–µ–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –≤–∞—à–µ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ.` : ''}`,
      context: 'symptoms'
    };
  }

  if (lowerMessage.includes('–ø—Ä–æ–≥–Ω–æ–∑') || lowerMessage.includes('–ø—Ä–µ–¥—Å–∫–∞–∑')) {
    return {
      content: `üîÆ **–ü—Ä–æ–≥–Ω–æ–∑—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö**:

üìÖ **–°–ª–µ–¥—É—é—â–∏–π —Ü–∏–∫–ª**:
‚Ä¢ –û–∂–∏–¥–∞–µ—Ç—Å—è: ${context.predictions?.nextCycleStart || '—á–µ—Ä–µ–∑ ~28 –¥–Ω–µ–π'}
‚Ä¢ –î–ª–∏–Ω–∞ —Ü–∏–∫–ª–∞: ${context.cycleTrends?.averageLength?.toFixed(0) || '28'} –¥–Ω–µ–π

‚ö†Ô∏è **–í–æ–∑–º–æ–∂–Ω—ã–µ —Å–∏–º–ø—Ç–æ–º—ã**: 
${context.predictions?.expectedSymptoms?.map(symptom => `‚Ä¢ ${symptom}`).join('\n') || '‚Ä¢ –ù–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω—ã...'}

üèÉ‚Äç‚ôÄÔ∏è **–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –¥–Ω–∏ –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏**: 
${context.predictions?.optimalWorkoutDays?.map(day => `‚Ä¢ –î–µ–Ω—å ${day} —Ü–∏–∫–ª–∞`).join('\n') || '‚Ä¢ –ü–ª–∞–Ω–∏—Ä—É–µ–º –ø–æ–¥ –≤–∞—à—É —Ñ–∞–∑—É —Ü–∏–∫–ª–∞'}

üéØ **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞**:
‚Ä¢ –ó–∞–ø–∞—Å–∏—Ç–µ—Å—å –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏ —Å ${context.predictions?.nutritionFocus?.join(', ') || '–∂–µ–ª–µ–∑–æ–º –∏ –º–∞–≥–Ω–∏–µ–º'}
‚Ä¢ –ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ —Ä–∞—Å—Å–ª–∞–±–ª—è—é—â–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ –ø–µ—Ä–≤—ã–µ –¥–Ω–∏ —Ü–∏–∫–ª–∞
‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ–ª–ª–∏–∫—É–ª—è—Ä–Ω—É—é —Ñ–∞–∑—É –¥–ª—è –≤–∞–∂–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤

üìä **–¢–æ—á–Ω–æ—Å—Ç—å –ø—Ä–æ–≥–Ω–æ–∑–∞**: ${context.cycleTrends?.regularityScore ? (context.cycleTrends.regularityScore * 0.8).toFixed(0) : '70'}% –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–≥—É–ª—è—Ä–Ω–æ—Å—Ç–∏ –≤–∞—à–∏—Ö —Ü–∏–∫–ª–æ–≤`,
      context: 'analysis'
    };
  }

  return {
    content: `–ü—Ä–∏–≤–µ—Ç! –Ø –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –∏ –≥–æ—Ç–æ–≤ –¥–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞–º, –ø–∏—Ç–∞–Ω–∏—é, —Å–∏–º–ø—Ç–æ–º–∞–º –∏ –ø—Ä–æ–≥–Ω–æ–∑–∞–º. –ß—Ç–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?`,
    context: 'general'
  };
};
